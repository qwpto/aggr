(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Alerts"],{"024c":function(t,e,s){"use strict";var a=s("9ab4"),i=s("2b0e"),n=s("2fe1");let r=class extends i["default"]{get pane(){return this.$store.state.panes.panes[this.paneId]}mounted(){this.$el.id=this.paneId,this.refreshZoom(),this.$nextTick(()=>{const t=this.$el.clientWidth;"function"===typeof this.onResize&&this.onResize(t,this.$el.clientHeight,!0)}),this.$el.addEventListener("mousedown",this.focusPane)}beforeDestroy(){this.$el.removeEventListener("mousedown",this.focusPane),this._onStoreMutation&&this._onStoreMutation()}refreshZoom(){this.$store.dispatch("panes/refreshZoom",{id:this.paneId})}focusPane(){this.$store.commit("app/SET_FOCUSED_PANE",this.paneId)}};r=Object(a["a"])([Object(n["b"])({props:{paneId:{required:!0,type:String}}})],r),e["a"]=r},7042:function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"alerts-list hide-scrollbar",class:[t.withOptions&&"alerts-list--with-options"]},[t.withOptions?e("div",{staticClass:"alert-list__header dropdown-item"},[e("label",{staticClass:"checkbox-control -small w-100",on:{click:function(t){t.stopPropagation()},mousedown:function(t){t.preventDefault()}}},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.alertsClick},on:{change:function(e){return t.$store.commit("settings/TOGGLE_ALERTS_CLICK")}}}),e("span",[t._v("1 click")]),e("i",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-info text-muted ml8",attrs:{title:"Place alerts faster ⚡️"}}),e("div",{staticClass:"mlauto"})])]):t._e(),t.filteredIndexes.length||t.isLoading?t._e():e("div",{staticClass:"alerts-list__empty px8 text-danger"},[e("i",{staticClass:"icon-cross -small"}),t._v(" no alerts "),t.query?[t._v(' matching "'+t._s(t.query)+'" ')]:t._e()],2),t._l(t.filteredIndexes,(function(s,a){return e("ToggableSection",{key:s.market,staticClass:"alerts-list__section",attrs:{model:t.sections,id:t.persistSections&&"alerts-"+s.market,"auto-close":"",small:""},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",{directives:[{name:"draggable-market",rawName:"v-draggable-market"}],staticClass:"toggable-section__title",attrs:{"data-market":s.market}},[t._v(" "+t._s(s.market)+" "),s.alerts.length>1?e("span",{staticClass:"badge -invert ml8"},[t._v(t._s(s.alerts.length))]):t._e()])]},proxy:!0},{key:"control",fn:function(){return[e("Btn",{ref:"clearBtns",refInFor:!0,staticClass:"-text mr16",on:{click:function(e){return t.clearAlerts(s,t.$refs.clearBtns[a])}}},[e("i",{staticClass:"icon-trash"})])]},proxy:!0}],null,!0)},[s.alerts.length?e("table",{staticClass:"table alerts-list__table"},[e("tbody",t._l(s.alerts,(function(s){return e("tr",{key:s.id,staticClass:"alerts-list-item",class:[s.triggered&&"alerts-list-item--triggered"]},[e("td",{staticClass:"table-input alerts-list-item__price"},[s.message?e("span",{directives:[{name:"tippy",rawName:"v-tippy",value:{followCursor:!0,distance:24},expression:"{ followCursor: true, distance: 24 }"}],attrs:{title:s.message}},[t._v(" "+t._s(t.formatPrice(s.price,s.market))+" ")]):e("span",[t._v(" "+t._s(t.formatPrice(s.price,s.market))+" ")])]),e("td",{staticClass:"alerts-list-item__status table-input text-nowrap text-right",class:[s.triggered&&"text-success"]},[s.triggered?[e("i",{staticClass:"icon-check"}),t._v(" Triggered ")]:s.active?[t._v("Active")]:[t._v("Inactive")]],2),s.triggered?e("td",{staticClass:"table-action -hover",on:{click:function(e){return e.stopPropagation(),t.removeAlert(s)}}},[e("button",{staticClass:"btn -text -small"},[e("i",{staticClass:"icon-cross"})])]):e("td",{staticClass:"table-action -hover",on:{click:function(e){return e.stopPropagation(),t.togglePresetDropdown(e,s)}}},[e("button",{staticClass:"btn -text -small"},[e("i",{staticClass:"icon-more"})])])])})),0)]):e("p",{staticClass:"text-danger pl8"},[t._v("No alerts")])])})),e("dropdown",{model:{value:t.alertDropdownTrigger,callback:function(e){t.alertDropdownTrigger=e},expression:"alertDropdownTrigger"}},[t.dropdownAlert&&!t.dropdownAlert.triggered?[e("Btn",{staticClass:"dropdown-item -cases",attrs:{type:"button",loading:t.isLoading},on:{click:function(e){e.stopPropagation(),t.checkStatus(t.dropdownAlert).then(()=>t.alertDropdownTrigger=null)}}},[e("i",{staticClass:"icon-search"}),e("span",[t._v("Check status")])]),e("div",{staticClass:"dropdown-divider"})]:t._e(),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(e){return t.removeAlert(t.dropdownAlert)}}},[e("i",{staticClass:"icon-cross"}),e("span",[t._v("Remove")])])],2)],2)},i=[],n=s("9ab4"),r=s("60a3"),o=s("ec0e"),l=s("be31"),c=s("017a"),p=s("f634"),d=s("0c01"),h=s("a914"),u=s("28f3"),m=s("06c2");let g=class extends r["c"]{constructor(){super(...arguments),this.dropdownAlert=null,this.alertDropdownTrigger=null,this.indexes=[],this.sections=[],this.isLoading=!1}get queryFilter(){return new RegExp(this.query,"i")}get alertsClick(){return this.$store.state.settings.alertsClick}get filteredIndexes(){return this.query?this.indexes.filter(t=>this.queryFilter.test(t.market)):this.indexes}async created(){if(await this.getAlerts(),1===this.filteredIndexes.length){const t="alerts-"+this.filteredIndexes[0].market;-1===this.$store.state.settings.sections.indexOf(t)&&this.$store.commit("settings/TOGGLE_SECTION",t)}h["a"].on("alert",this.onAlert)}beforeDestroy(){h["a"].off("alert",this.onAlert)}async getAlerts(){this.isLoading=!0;const t=await l["a"].getAllAlerts();for(let e=0;e<t.length;e++)this.$set(this.indexes,e,t[e]);await Object(u["y"])(100),this.isLoading=!1}formatPrice(t,e){return Object(m["d"])(t,e)}togglePresetDropdown(t,e){this.alertDropdownTrigger?this.alertDropdownTrigger=null:(this.alertDropdownTrigger=t.currentTarget,this.dropdownAlert=e)}async removeAlert(t){this.isLoading=!0,await p["b"].removeAlert(t),this.isLoading=!1}async createAlert(t){this.isLoading=!0,await p["b"].createAlert(t),this.isLoading=!1}async checkStatus(t){this.isLoading=!0;const e=await p["b"].toggleAlert(t.market,t.price,void 0,void 0,!0);if(this.isLoading=!1,e.alert)d["a"].confirm({message:`Alert ${t.market} @<code>${t.price}</code> is still pending`,html:!0,ok:"Ok",cancel:null});else{const e=await d["a"].confirm({title:"Not found",message:"Alert already triggered or expired",html:!0,ok:"Recreate",actions:[{label:"Remove",callback:()=>2}]});e?2===e?this.removeAlert(t):this.createAlert(t):await p["b"].deactivateAlert(t)}}onAlert({price:t,market:e,type:s,newPrice:a,message:i}){let n=this.indexes.find(t=>t.market===e);if(!n){if(s!==p["a"].CREATED)return;this.$set(this.indexes,this.indexes.length,{market:e,alerts:[]}),n=this.indexes[this.indexes.length-1],-1===this.sections.indexOf("alerts-"+this.sections)&&this.sections.push("alerts-"+this.sections)}const r=n.alerts.findIndex(e=>e.price===t);-1!==r?s===p["a"].DELETED?(n.alerts.splice(r,1),n.alerts.length||this.indexes.splice(this.indexes.indexOf(n),1)):s===p["a"].UPDATED?this.$set(n.alerts[r],"price",a):s===p["a"].TRIGGERED?this.$set(n.alerts[r],"triggered",!0):s===p["a"].ACTIVATED?(this.$set(n.alerts[r],"active",!0),"undefined"!==typeof i&&this.$set(n.alerts[r],"message",i)):s===p["a"].DEACTIVATED&&this.$set(n.alerts[r],"active",!1):s===p["a"].CREATED&&this.$set(n.alerts,n.alerts.length,{price:t,market:e})}async clearAlerts(t,e){if(!await d["a"].confirm({message:`Remove all ${t.market} alerts`,ok:`Yes (${t.alerts.length})`}))return;e&&(e.loading=!0);const s=[...t.alerts];for(const a of s)await p["b"].removeAlert(a);await l["a"].saveAlerts({market:t.market,alerts:[]}),e&&(e.loading=!1)}};g=Object(n["a"])([Object(r["a"])({components:{ToggableSection:o["a"],Btn:c["a"]},name:"Alerts",props:{query:{type:String,default:""},persistSections:{type:Boolean,default:!1},withOptions:{type:Boolean,default:!1}}})],g);var f=g,b=f,_=(s("a1a4"),s("2877")),v=Object(_["a"])(b,a,i,!1,null,"33d63b47",null);e["a"]=v.exports},"7b89":function(t,e,s){},"825f":function(t,e,s){"use strict";s("f25e")},"8c91":function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"pane-header hide-scrollbar d-flex",class:[t.split&&"pane-header--split"],on:{dblclick:t.maximizePane}},[t.showName&&t.name?e("div",{staticClass:"pane-header__name pane-overlay",on:{dblclick:t.renamePane}},[t._t("title",(function(){return[t._v(" "+t._s(t.name)+" ")]}))],2):t._e(),e("div",{staticClass:"toolbar pane-overlay"},[t._t("default"),t.showSearch?e("button",{staticClass:"btn toolbar__label toolbar__label--768 -text",attrs:{type:"button"},on:{click:t.openSearch}},[e("i",{staticClass:"icon-search"})]):t._e(),t.settings?e("btn",{staticClass:"toolbar__label toolbar__label--768 -text",attrs:{type:"button",loading:t.isLoading},on:{click:t.openSettings}},[e("i",{staticClass:"icon-cog"})]):t._e(),e("button",{staticClass:"btn -text toolbar__label",attrs:{type:"button"},on:{click:t.toggleDropdown}},[e("i",{staticClass:"icon-more"})]),e("dropdown",{model:{value:t.paneDropdownTrigger,callback:function(e){t.paneDropdownTrigger=e},expression:"paneDropdownTrigger"}},[e("div",{staticClass:"d-flex btn-group"},[e("button",{staticClass:"btn -green",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.changeZoom(e,-1)}}},[e("i",{staticClass:"icon-minus"})]),e("button",{staticClass:"btn -green text-monospace flex-grow-1 text-center",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.resetZoom.apply(null,arguments)}}},[t._v(" × "+t._s(t.zoom.toFixed(2))+" ")]),e("button",{staticClass:"btn -green",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.changeZoom(e,1)}}},[e("i",{staticClass:"icon-plus"})])]),null!==t.settings?e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.openSettings}},[e("i",{staticClass:"icon-cog"}),e("span",[t._v("Settings")])]):t._e(),t.showSearch?e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.openSearch}},[e("i",{staticClass:"icon-search"}),e("span",[t._v("Sources")])]):t._e(),t.$slots.menu?e("div",{staticClass:"dropdown-divider",attrs:{"data-label":t.paneId+" options"}}):t._e(),t._t("menu"),e("div",{staticClass:"dropdown-divider",attrs:{"data-label":"utilities"}}),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.maximizePane}},[e("i",{staticClass:"icon-enlarge"}),e("span",[t._v("Maximize")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.duplicatePane}},[e("i",{staticClass:"icon-copy-paste"}),e("span",[t._v("Duplicate")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.downloadPane}},[e("i",{staticClass:"icon-download"}),e("span",[t._v("Download")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.renamePane}},[e("i",{staticClass:"icon-edit"}),e("span",[t._v("Rename")])]),e("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:t.removePane}},[e("i",{staticClass:"icon-trash"}),e("span",[t._v("Remove")])])],2)],2)])},i=[],n=s("9ab4"),r=s("2b0e"),o=s("2fe1"),l=s("017a"),c=s("28f3"),p=s("0c01");let d=class extends r["default"]{constructor(){super(...arguments),this.paneDropdownTrigger=null,this.isLoading=!1}get zoom(){return this.$store.state.panes.panes[this.paneId].zoom||1}get type(){return this.$store.state.panes.panes[this.paneId].type}get name(){const t=this.$store.state.panes.panes[this.paneId].name,e=this.$store.state.panes.marketsListeners[this.$store.state.panes.panes[this.paneId].markets[0]];return t?t.trim():e?e.local:this.type}openSearch(){this.$store.dispatch("app/showSearch",{paneId:this.paneId})}changeZoom(t,e){const s=this.zoom+(t.shiftKey?.0625:.125)*e;this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:s}),this.$emit("zoom",s)}resetZoom(){this.$store.dispatch("panes/setZoom",{id:this.paneId,zoom:1}),this.$emit("zoom",1)}async removePane(){await p["a"].confirm(`Delete pane ${this.type} "${this.name}" ?`)&&this.$store.dispatch("panes/removePane",this.paneId)}duplicatePane(){this.$store.dispatch("panes/duplicatePane",this.paneId)}maximizePane(t){if("dblclick"===t.type&&t.currentTarget!==t.target)return;const e=this.$el.parentElement.parentElement,s=e.classList.toggle("-maximized"),a=Object(c["p"])(e);for(const n of a)n.getAttribute("type")&&(n.classList.remove("-maximized"),n.style.display=s?"none":"block");const i=Event;window.dispatchEvent(new i("resize")),this.$store.dispatch("panes/refreshZoom",{id:this.paneId,zoom:s?2:this.zoom})}async renamePane(t){t&&t.stopPropagation();const e=await p["a"].prompt({action:"Rename",input:this.name});"string"===typeof e&&e!==this.name&&this.$store.commit("panes/SET_PANE_NAME",{id:this.paneId,name:e})}async downloadPane(){Object(c["g"])({name:`${this.type}:${this.paneId}`,type:this.type,data:this.$store.state[this.paneId],markets:this.$store.state.panes.panes[this.paneId].markets,createdAt:Date.now(),updatedAt:null},Object(c["z"])(this.paneId))}toggleDropdown(t){this.paneDropdownTrigger?this.paneDropdownTrigger=null:this.paneDropdownTrigger=t.currentTarget}async openSettings(){this.settings&&(this.isLoading=!0,p["a"].open((await this.settings()).default,{paneId:this.paneId}),this.isLoading=!1)}};d=Object(n["a"])([Object(o["b"])({name:"PaneHeader",props:{paneId:{type:String},settings:{type:Function,default:null},showSearch:{type:Boolean,default:!0},showName:{type:Boolean,default:!0},split:{type:Boolean,default:!0}},components:{Btn:l["a"]}})],d);var h=d,u=h,m=s("2877"),g=Object(m["a"])(u,a,i,!1,null,null,null);e["a"]=g.exports},a1a4:function(t,e,s){"use strict";s("7b89")},f25e:function(t,e,s){},f749:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"pane-alerts"},[e("pane-header",{staticClass:"pane-alerts__header",attrs:{paneId:t.paneId,settings:()=>s.e("chunk-dce2434e").then(s.bind(null,"6faf")),"show-search":!1,"show-name":!1}},[e("Btn",{staticClass:"toolbar__label -text",attrs:{type:"button"},on:{click:function(e){return t.$refs.list.getAlerts()}}},[e("i",{staticClass:"icon-refresh"})])],1),e("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],ref:"query",staticClass:"form-control pane-alerts__query pane-overlay",attrs:{type:"text",placeholder:"Search..."},domProps:{value:t.query},on:{input:function(e){e.target.composing||(t.query=e.target.value)}}}),e("alerts-list",{ref:"list",attrs:{query:t.query,"persist-sections":""}})],1)},i=[],n=s("9ab4"),r=s("60a3"),o=s("ec0e"),l=s("024c"),c=s("8c91"),p=s("017a"),d=s("7042");let h=class extends(Object(r["b"])(l["a"])){constructor(){super(...arguments),this.query=""}};h=Object(n["a"])([Object(r["a"])({components:{PaneHeader:c["a"],ToggableSection:o["a"],AlertsList:d["a"],Btn:p["a"]},name:"Alerts"})],h);var u=h,m=u,g=(s("825f"),s("2877")),f=Object(g["a"])(m,a,i,!1,null,"23e4ebd0",null);e["default"]=f.exports}}]);