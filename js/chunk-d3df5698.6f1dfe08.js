(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d3df5698"],{"0e0a":function(t,e,s){},"411d":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("Dialog",{ref:"dialog",staticClass:"search-dialog",on:{clickOutside:t.hide},scopedSlots:t._u([{key:"header",fn:function(){return[t.paneId?e("div",[e("div",{staticClass:"dialog__title"},[t._v(" Connect "),e("code",{staticClass:"-filled -green"},[t._v(t._s(t.paneName))]),e("button",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"btn -small ml4 -text",attrs:{type:"button",title:"Target all instead"},on:{click:t.detargetPane}},[e("i",{staticClass:"icon-cross"})])])]):e("div",[e("div",{staticClass:"dialog__title"},[t._v("Manage connections")])]),t.isPreloading?e("Loader",{staticClass:"mtauto mbauto mr0",attrs:{small:""}}):t._e(),e("div",{staticClass:"column -center"})]},proxy:!0},{key:"footer",fn:function(){return[e("btn",{staticClass:"btn -text mrauto search-dialog__side-toggle",on:{click:function(e){t.mobileShowFilters=!t.mobileShowFilters}}},[e("i",{staticClass:"icon-cog"})]),e("a",{staticClass:"btn -text",attrs:{href:"javascript:void(0);"},on:{click:t.hide}},[t._v("Cancel")]),e("btn",{staticClass:"-large -green ml8",attrs:{loading:t.isLoading},nativeOn:{click:function(e){return t.submit.apply(null,arguments)}}},[t._v(" "+t._s(t.submitLabel)+" ")])]},proxy:!0}])},[e("div",{staticClass:"search-dialog__side hide-scrollbar",class:{"-show":t.mobileShowFilters}},[e("ToggableSection",{attrs:{title:"Extras",persistent:"",id:"search-extras"}},[e("label",{staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.searchTypes.normalize},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","normalize")}}}),e("div"),e("span",[t._v("Group by pair")])]),e("label",{staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.searchTypes.mergeUsdt},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","mergeUsdt")}}}),e("div"),e("span",[t._v("Merge stablecoins")])]),e("label",{staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.searchTypes.historical},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","historical")}}}),e("div"),e("span",[t._v("With historical data")])]),e("label",{staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.searchTypes.recent},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","recent")}}}),e("div"),e("span",[t._v("Show recents")])])]),e("ToggableSection",{attrs:{title:"Exchanges",id:"search-exchanges"},scopedSlots:t._u([{key:"control",fn:function(){return[e("label",{staticClass:"checkbox-control -small flex-right"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.allExchangesEnabled},on:{change:t.toggleAll}}),e("div")])]},proxy:!0}])},[t._l(t.exchanges,(function(s){return[t.$store.state.exchanges[s].disabled?t._e():e("label",{key:s,staticClass:"checkbox-control -small mb4 -custom hide-scrollbar"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:!1!==t.searchExchanges[s]},on:{click:function(e){return t.toggleExchange(e,s)}}}),e("div",{class:"icon-"+s}),e("span",[e("span",{domProps:{textContent:t._s(s)}}),t.canRefreshProducts?e("a",{directives:[{name:"tippy",rawName:"v-tippy",value:{boundary:"window",placement:"left"},expression:"{ boundary: 'window', placement: 'left' }"}],staticClass:"-text",attrs:{href:"javascript:void(0);",title:`Refresh ${s}'s products`},on:{click:function(e){return e.stopPropagation(),t.refreshExchangeProducts(s)}}},[e("i",{staticClass:"icon-refresh ml8 mr8"})]):t._e()])])]}))],2),e("ToggableSection",{attrs:{title:"Type",id:"search-type"}},[e("label",{staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.searchTypes.spots},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","spots")}}}),e("div"),e("span",[t._v("Spots")])]),e("label",{staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.searchTypes.perpetuals},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","perpetuals")}}}),e("div"),e("span",[t._v("Perpetuals")])]),e("label",{staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:t.searchTypes.futures},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","futures")}}}),e("div"),e("span",[t._v("Futures")])])]),e("ToggableSection",{attrs:{id:"search-quotes"},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",{staticClass:"toggable-section__title"},[t._v(" Currency "),t.quotesCount.length?e("span",{staticClass:"badge -red ml8 mr8"},[t._v(t._s(t.quotesCount.length))]):t._e()])]},proxy:!0}])},t._l(t.quoteCurrencies,(function(s){return e("label",{key:s,staticClass:"checkbox-control -small mb4"},[e("input",{staticClass:"form-control",attrs:{type:"checkbox"},domProps:{checked:!0===t.searchQuotes[s]||void 0===t.searchQuotes[s]},on:{change:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_QUOTE",{key:s,value:e.target.checked})}}}),e("div"),e("span",[t._v(t._s(s))])])})),0)],1),e("div",{ref:"scroller",staticClass:"search-dialog__wrapper hide-scrollbar"},[e("div",{ref:"selection",staticClass:"search-dialog-selection search-dialog__tags form-control",class:t.groupsCount<10&&"-sticky",on:{click:function(e){return t.$refs.input.focus()}}},[t.selection.length?e("div",{staticClass:"search-dialog-selection__controls d-flex btn-group"},[e("button",{directives:[{name:"tippy",rawName:"v-tippy",value:{boundary:"window",placement:"bottom"},expression:"{ boundary: 'window', placement: 'bottom' }"}],staticClass:"btn -text -small",attrs:{title:"Toggle grouping"},on:{click:function(e){return t.$store.commit("settings/TOGGLE_SEARCH_TYPE","normalize")}}},[e("i",{staticClass:"icon-merge"})]),e("button",{directives:[{name:"tippy",rawName:"v-tippy",value:{boundary:"window",placement:"bottom"},expression:"{ boundary: 'window', placement: 'bottom' }"}],staticClass:"btn -text -small",attrs:{title:"Clear"},on:{click:t.clearSelection}},[e("i",{staticClass:"icon-eraser"})])]):t._e(),t.searchTypes.normalize?t._l(t.groupedSelection,(function(s,i){return e("button",{key:i,staticClass:"search-dialog__tags-item btn -green -pill",attrs:{title:"Click to remove "+s.join(", ")},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleMarkets(s)}}},[s.length>1?e("span",{staticClass:"badge -green ml8",domProps:{textContent:t._s(s.length)}}):t._e(),e("span",{domProps:{textContent:t._s(i)}})])})):t._l(t.selection,(function(s){return e("button",{key:s,staticClass:"search-dialog__tags-item btn",class:{"-green":-1!==t.activeMarkets.indexOf(s)},attrs:{title:"Click to remove"},domProps:{textContent:t._s(s)},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleMarkets(s)}}})})),e("input",{ref:"input",staticClass:"search-dialog__tags-item",attrs:{type:"text",placeholder:"Search"},domProps:{value:t.query},on:{input:function(e){t.page=0,t.query=e.target.value}}})],2),e("div",{staticClass:"search-dialog__results"},[t.results.length?[t.page>0?e("div",{staticClass:"d-flex mt8"},[e("button",{staticClass:"mx8 btn -text mlauto switch-page",on:{click:t.showLess}},[t._v(" ... go page "+t._s(t.page)+" ")])]):t._e(),t.searchTypes.recent&&t.previousSearchSelections.length&&!t.query.length?e("table",{staticClass:"table mt8 search-dialog-recents table--inset"},[e("thead",[e("tr",[e("th",{attrs:{colspan:"100%"}},[t._v(" Search history "),e("button",{staticClass:"btn -small -text",on:{click:function(e){return t.toggleType("recent")}}},[e("i",{staticClass:"icon-cross"})])])])]),e("tbody",t._l(t.previousSearchSelections,(function(s){return e("tr",{key:s.label,staticClass:"-action",attrs:{title:s.markets.join(", ")},on:{click:function(e){return t.toggleMarkets(s.markets,e.shiftKey)}}},[e("td",{staticClass:"search-dialog-recents__label"},[t._v(" "+t._s(s.label)+" "),s.count>1?e("span",{staticClass:"badge -invert ml8",domProps:{textContent:t._s(s.markets.length)}}):t._e()]),e("td",{staticClass:"search-dialog-recents__markets table-ellipsis text-nowrap"},[e("small",[t._v(t._s(s.markets.join(", ")))])])])})),0)]):t._e(),t.searchTypes.normalize?e("table",{staticClass:"table mt8 table--inset"},[e("tbody",t._l(t.results,(function(s,i){return e("tr",{key:s.localPair,staticClass:"-action",class:{active:t.activeIndex===i},on:{click:function(e){return t.toggleMarkets(s.markets)}}},[e("td",{domProps:{textContent:t._s(s.localPair)}}),e("td",{staticClass:"-lower"},[e("span",{staticClass:"search-dialog__group-count"},[e("div",{staticClass:"badge mr8"},[t._v(" "+t._s(s.markets.length)+" ")])]),t._l(s.exchanges,(function(t,s){return e("i",{key:s,staticClass:"pr4 search-dialog__exchange-logo",class:"icon-"+s,attrs:{title:t.join(", ")}})}))],2)])})),0)]):e("table",{staticClass:"table table--inset mt8"},[e("tbody",t._l(t.results,(function(s,i){return e("tr",{key:s.id,staticClass:"-action",class:{active:t.activeIndex===i},on:{click:function(e){return t.toggleMarkets([s.id])}}},[e("td",{staticClass:"icon search-dialog__exchange text-center text-color-base",class:"icon-"+s.exchange}),e("td",{domProps:{textContent:t._s(s.exchange)}}),e("td",{domProps:{textContent:t._s(s.pair)}}),e("td",{domProps:{textContent:t._s(s.type)}}),e("td",{staticClass:"text-center"},[-1!==t.historicalMarkets.indexOf(s.id)?e("i",{staticClass:"icon-candlestick",attrs:{title:"historical data available for this market"}}):t._e()])])})),0)]),e("div",{staticClass:"mt8 d-flex"},[e("button",{staticClass:"mx8 btn -text",on:{click:t.addAll}},[e("i",{staticClass:"icon-plus mr8"}),t._v(" add all of the above ")]),t.results.length===t.resultsPerPage?e("button",{staticClass:"mx8 btn -text mlauto switch-page",on:{click:t.showMore}},[t._v(" go page "+t._s(t.page+2)+" ... ")]):t._e()])]:t.query.length?e("p",{staticClass:"mb0 pb0 ml16"},[e("span",{staticClass:"text-muted"},[t._v('No results found for "'+t._s(t.query)+'".')]),e("br"),t.hasFilters||!t.allExchangesEnabled?e("button",{staticClass:"btn -cases -text",on:{click:t.clearFilters}},[e("i",{staticClass:"icon-eraser mr8"}),t._v(" remove filters ")]):t._e()]):t._e()],2)])])},a=[],n=s("4bfa"),o=s("017a"),r=s("7250"),c=s("1ea0"),l=s("28f3"),h=s("0c01"),u=s("be31"),d=s("06c2"),p=s("ec0e");const g=25;var m={mixins:[c["a"]],components:{ToggableSection:p["a"],Dialog:r["a"],Btn:o["a"],Loader:n["a"]},props:{paneId:{required:!1},pristine:{type:Boolean,default:!1},input:{type:String,default:null}},data:()=>({page:0,query:"",markets:[],isLoading:!1,isPreloading:!1,productsReady:!1,selection:[],originalSelection:[],activeIndex:null,mobileShowFilters:!1,canRefreshProducts:!0,flattenedProducts:[],quoteCurrencies:["USD","USDT","UST","USDC","USDD","BUSD","TUSD","ETH","BTC","BNB","EUR","AUD","GBP","OTHERS"]}),computed:{previousSearchSelections(){return this.$store.state.settings.previousSearchSelections},resultsPerPage(){return g},otherPanes(){return Object.keys(this.$store.state.panes.panes).filter(t=>t!==this.paneId).map(t=>this.$store.state.panes.panes[t])},paneName(){return this.paneId?this.$store.state.panes.panes[this.paneId].name||this.paneId:null},activeMarkets(){return Object.keys(this.$store.state.panes.marketsListeners)},paneMarkets(){return this.paneId?this.$store.state.panes.panes[this.paneId].markets:[]},toConnect(){return this.paneId?this.selection.filter(t=>-1===this.paneMarkets.indexOf(t)).length:this.selection.filter(t=>-1===this.activeMarkets.indexOf(t)).length},toDisconnect(){return this.originalSelection.filter(t=>-1===this.selection.indexOf(t)).length},submitLabel(){const t=+this.toConnect,e=+this.toDisconnect;return!this.selection.length&&e?`disconnect (${e})`:t?`connect (${t})`:"refresh"},searchTypes(){return this.$store.state.settings.searchTypes},searchQuotes(){const t=this.$store.state.settings.searchQuotes;return this.quoteCurrencies.reduce((e,s)=>(e[s]="undefined"!==typeof t[s]&&t[s],e),{})},quotesCount(){return Object.values(this.searchQuotes).filter(t=>!!t)},allQuotes(){return!this.quotesCount.length},exchanges(){return this.$store.getters["exchanges/getExchanges"]},searchExchanges(){const t=this.$store.state.settings.searchExchanges;return Object.keys(this.$store.state.exchanges).reduce((e,s)=>(this.$store.state.exchanges[s].disabled||(e[s]="undefined"===typeof t[s]||t[s]),e),{})},allExchangesEnabled(){return"undefined"===typeof Object.values(this.searchExchanges).find(t=>!1===t)},hasFilters(){const t=this.searchTypes.historical,e=this.searchTypes.spots,s=this.searchTypes.perpetuals,i=this.searchTypes.futures,a=this.searchTypes.mergeUsdt;return a||t||e||s||i},historicalMarkets(){return this.$store.state.app.historicalMarkets},queryFilter:function(){const t=this.query.replace(/[ ,]/g,"|").replace(/(^|\w|\s)\*(\w|\s|$)/g,"$1.*$2");return this.searchTypes.normalize?new RegExp("^"+t,"i"):new RegExp(t,"i")},filteredProducts(){const t=this.searchTypes.historical,e=this.searchTypes.spots,s=this.searchTypes.perpetuals,i=this.searchTypes.futures,a=this.searchExchanges,n=e||s||i,o=this.searchQuotes,r=this.allQuotes;return this.page=0,this.flattenedProducts.filter(c=>(!t||-1!==this.historicalMarkets.indexOf(c.id))&&(!(!r&&("boolean"===typeof o[c.quote]&&!1===o[c.quote]||"boolean"!==typeof o[c.quote]&&!o.OTHERS))&&(!!a[c.exchange]&&(!n||!(!i&&"future"===c.type||!s&&"perp"===c.type||!e&&"spot"===c.type)))))},results:function(){const t=this.page*g;if(this.searchTypes.normalize){const e=this.filteredProducts.filter(t=>-1===this.selection.indexOf(t.id)&&this.queryFilter.test(t.local)).reduce((t,e)=>{let s;return s=e&&this.searchTypes.mergeUsdt?e.base+Object(d["p"])(e.quote):e.base+e.quote,t[s]||(t[s]=[]),t[s].push(e.id),t},{});return Object.keys(e).slice(t,t+g).map(t=>({localPair:t,markets:e[t],exchanges:e[t].reduce((t,e)=>{const[s,i]=Object(d["m"])(e),a=s.replace(/_.*/,"");return t[a]||(t[a]=[]),t[a].push(i),t},{})}))}return this.filteredProducts.filter(t=>-1===this.selection.indexOf(t.id)&&this.queryFilter.test(t.id)).slice(t,t+g)},groupedSelection:function(){return this.productsReady?this.selection.reduce((t,e)=>{const[s]=e.split(":");if(!d["k"][s])return t;const i=d["k"][s].find(t=>t.id===e);let a=e;return i&&(a=i&&this.searchTypes.mergeUsdt?i.base+Object(d["p"])(i.quote):i.base+i.quote),t[a]||(t[a]=[]),t[a].push(e),t},{}):{}},groupsCount(){return Object.keys(this.groupedSelection).length}},watch:{"$store.state.app.showSearch":function(t){t||this.close(!1)},async searchExchanges(){await this.ensureIndexedProducts()&&this.cacheProducts()}},async created(){this.initSelection(),this.isPreloading=!0,await this.ensureIndexedProducts(),this.isPreloading=!1,this.cacheProducts()},async mounted(){document.addEventListener("paste",this.onPaste),document.addEventListener("keydown",this.onKeydown),await this.$nextTick(),this.$refs.input&&(this.$refs.input.focus(),this.input&&!window.event&&0!==this.$refs.input.value.indexOf(this.input)&&(this.query=this.input+this.query))},beforeDestroy(){document.removeEventListener("paste",this.onPaste),document.removeEventListener("keydown",this.onKeydown),this._hideHistoryTimeout&&clearTimeout(this._hideHistoryTimeout)},methods:{async ensureIndexedProducts(){const t=this.selection.reduce((t,e)=>{const[s]=Object(d["m"])(e);return t[s]||(t[s]=!0),t},{}),e={...this.searchExchanges,...t},s=await Object(d["b"])(e);return this.productsReady=!0,!!s},detargetPane(){this.$store.commit("app/SET_FOCUSED_PANE",null),this.paneId=null,this.initSelection()},initSelection(){this.pristine||(this.paneId?this.selection=this.$store.state.panes.panes[this.paneId].markets.slice():this.selection=this.activeMarkets.slice(),this.originalSelection=this.selection.slice())},containMultipleMarketsConfigurations(){return Object.keys(this.$store.state.panes.panes).map(t=>Object(l["l"])(this.$store.state.panes.panes[t].markets)).filter((t,e,s)=>s.indexOf(t)===e).length>1},async toggleMarkets(t,e){const s=this.$refs.selection.scrollTop;if(Array.isArray(t)||(t=[t]),e)return this.$store.commit("settings/REMOVE_SEARCH_HISTORY",t),void clearTimeout(this._hideHistoryTimeout);for(const i of t)this.toggleMarket(i);await this.$nextTick(),this.$refs.input.focus(),this.$refs.selection.scrollTop=s},toggleMarket(t){const e=this.selection.indexOf(t);-1===e?this.selection.push(t):this.selection.splice(e,1)},async submit(){if(this.selection.length&&this.$store.dispatch("settings/saveSearchSelection",this.selection),this.paneId)this.isLoading=!0,this.$store.dispatch("panes/setMarketsForPane",{id:this.paneId,markets:this.selection});else{if(this.containMultipleMarketsConfigurations()&&!await h["a"].confirm("Override the other panes market filters"))return;this.isLoading=!0,Object.keys(this.$store.state.panes.panes).length||await this.$store.dispatch("panes/addPane",{type:"trades"}),await this.$store.dispatch("panes/setMarketsForAll",this.selection)}this.isLoading=!1,this.hide()},hide(){this.$store.dispatch("app/hideSearch")},toggleType(t){this.$store.commit("settings/TOGGLE_SEARCH_TYPE",t)},toggleExchange(t,e){t.shiftKey&&(this.toggleAll(!1),t.target.checked||(t.target.checked=!0)),this.$store.commit("settings/TOGGLE_SEARCH_EXCHANGE",e)},clearSelection(){this.selection.splice(0,this.selection.length),this.query="",this.$refs.input.focus()},copySelection(){Object(l["d"])(this.selection.join(",")),this.$store.dispatch("app/showNotice",{id:"products-clipboard",title:`Copied ${this.selection.length} product(s) to clipboard`})},clearFilters(){this.$store.commit("settings/CLEAR_SEARCH_FILTERS"),this.toggleAll(!0)},onPaste(t){if(document.activeElement&&"INPUT"===document.activeElement.tagName)return;const e=t.clipboardData.getData("text/plain"),s=e.split(",").filter(t=>/^.{3,}:.{4,32}$/.test(t));s.length&&(this.selection=s)},onKeydown(t){switch(t.key){case"Enter":t.preventDefault(),this.results[this.activeIndex]&&(this.searchTypes.normalize?this.toggleMarkets([this.results[this.activeIndex].markets]):this.toggleMarkets([this.results[this.activeIndex].id]));break;case"ArrowDown":case"ArrowUp":this.results.length&&("ArrowUp"===t.key?this.activeIndex=Math.max(0,this.activeIndex-1):null===this.activeIndex?this.activeIndex=0:this.activeIndex=Math.min(this.results.length-1,this.activeIndex+1));break;case"Backspace":case"Delete":this.deleteLast();break;case"c":!t.ctrlKey&&!t.metaKey||window.getSelection().toString().length||this.copySelection();break}},deleteLast(){if(!this.query.length&&this.selection.length)if(this.searchTypes.normalize){const t=Object.keys(this.groupedSelection).pop();this.toggleMarkets(this.groupedSelection[t])}else this.selection.splice(this.selection.length-1,1)},addAll(){const t=this.searchTypes.normalize,e=[];for(let s=0;s<this.results.length;s++)if(t)for(const t of this.results[s].markets)e.push(t);else e.push(this.results[s].id);this.toggleMarkets(e)},toggleAll(t){"boolean"!==typeof t&&(t=Boolean(!this.allExchangesEnabled)),this.$set(this.$store.state.settings,"searchExchanges",this.exchanges.reduce((e,s)=>(e[s]=!!t,e),{}))},async refreshExchangeProducts(t){if(!t){if(await h["a"].confirm("Download all exchange's products ?\n\nThis might take a while."))for(const t of this.exchanges)await this.refreshExchangeProducts(t);return}this._refreshProductsTimeout&&clearTimeout(this._refreshProductsTimeout),this.canRefreshProducts=!1,this.$store.dispatch("app/showNotice",{id:t,title:`Refreshing ${t}'s products...`}),await u["a"].deleteProducts(t);const e=(await Object(d["j"])(t,await Object(d["g"])(t,!0))).length;this.$store.dispatch("app/showNotice",{id:t,title:`Saved ${e} ${t}'s products`}),await this.$store.dispatch("exchanges/disconnect",t),await this.$store.dispatch("exchanges/connect",t),this._refreshProductsTimeout=setTimeout(()=>{this._refreshProductsTimeout=null,this.canRefreshProducts=!0},1e4),this.cacheProducts()},async showMore(){this.page++,await this.$nextTick(),this.$refs.scroller.scrollTop=0},async showLess(){this.page=Math.max(this.page-1,0),await this.$nextTick(),this.$refs.scroller.scrollTop=this.$refs.scroller.offsetHeight},cacheProducts(){this.flattenedProducts=Array.prototype.concat(...Object.values(d["k"]))}}},f=m,b=(s("766b"),s("2877")),y=Object(b["a"])(f,i,a,!1,null,"061da75b",null);e["default"]=y.exports},"766b":function(t,e,s){"use strict";s("0e0a")}}]);